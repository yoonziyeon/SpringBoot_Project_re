<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="AdminMember"> 

   <!-- 검색전후 회원수 -->
   <select id="am_count" parameterType="page" resultType="int">
      select count(mem_id) from member
      <where>
        <if test="find_field == ''"></if> <!-- 전체회원수 -->
        <if test="find_field == 'mem_id'"> <!-- 회원아이디로 검색할 때 -->
         mem_id like #{find_name}
        </if>
        <if test="find_field == 'mem_name'"> <!-- 회원이름으로 검색할 때 -->
         mem_name like #{find_name}        
        </if>
      </where>
   </select>
   
   <!-- 검색전후 회원목록 -->
   <select id="am_list" parameterType="page" resultType="member">
      select * from (select rowNum rNum, mem_id, mem_name,mem_phone01, mem_phone02, mem_phone03
      ,mem_state,mem_date from 
      (select * from member
      <where>
        <if test="find_field == ''"></if> <!-- 전체회원수 -->
        <if test="find_field == 'mem_id'"> <!-- 회원아이디로 검색할 때 -->
         mem_id like #{find_name}
        </if>
        <if test="find_field == 'mem_name'"> <!-- 회원이름으로 검색할 때 -->
         mem_name like #{find_name}        
        </if>
       </where> 
      order by mem_id asc))
      where rNum &gt;= #{startrow} and rNum &lt;= #{endrow}
      <!-- &gt;은 >, &lt;은 < -->
   </select>
   
   <!-- 관리자 회원관리 상세정보와 수정폼 -->
   <select id="am_info" parameterType="java.lang.String" resultType="net.daum.vo.MemberVO">
      select * from member where mem_id=#{mem_id}
   </select>
   
   <!-- 관리자로 사용자 회원정보 수정 -->
   <update id="am_edit">
     update member set mem_pwd=#{mem_pwd}, mem_name=#{mem_name}, mem_zip=#{mem_zip},
     mem_zip2=#{mem_zip2}, mem_addr=#{mem_addr}, mem_addr2=#{mem_addr2},
     mem_phone01=#{mem_phone01},mem_phone02=#{mem_phone02},mem_phone03=#{mem_phone03},
     mail_id=#{mail_id}, mail_domain=#{mail_domain}, mem_state=#{mem_state},
     mem_delcont=#{mem_delcont} where mem_id=#{mem_id}
   </update>
   
   <!-- 관리자로 사용자회원 삭제 -->
   <delete id="am_del">
     delete member where mem_id=#{mem_id} <!-- from 절문 생략가능 -->
   </delete>
</mapper>









